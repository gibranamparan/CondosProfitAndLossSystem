@model Sunvalley_PLSystem.Models.House

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
    Sunvalley_PLSystem.Models.VmFilter.VmAprov f = new Sunvalley_PLSystem.Models.VmFilter.VmAprov();
    IEnumerable<Sunvalley_PLSystem.Models.Movement> m = ViewBag.Movements1;
    IEnumerable<Sunvalley_PLSystem.Models.Movement> Loss = ViewBag.Loss;
    String mensaje = ViewBag.mensaje;

}

<h3>Montly Statement</h3>
<div id="empresa_info" class="row visible-print">
    <div class="col-md-6 pull-right">
        <img id="logo" class="col-md-6" src="~/app/img/Sol.png" alt="SUN VALLEY SERVICES" />
        <div id="logo_legend" class="col-md-6">
            <p>
                @Html.Raw(mensaje.Replace(Environment.NewLine, "<br/>"))
            </p>
        </div>
    </div>
</div>

<div class="panel" style="width:103% !important">
        <div class="panel panel-warning" style="width:100%">
            <div class="panel-heading hidden-print">
                House Details
            </div>
            <div class="panel-body">
                <table id="Details" class="table  table-striped table-hover table-responsive">
                    <tr>
                        <th>
                            @Html.DisplayNameFor(model => model.ApplicationUser.firstName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.ApplicationUser.lastName)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.name)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.created)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.area)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.adress)
                        </th>

                        <th>
                            @Html.DisplayNameFor(model => model.cityArea)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.country)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.stateProvince)
                        </th>
                        <th>
                            @Html.DisplayNameFor(model => model.postalCode)
                        </th>

                    </tr>

                    <tr>
                        <td>
                            @Html.DisplayFor(model => model.ApplicationUser.firstName)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.ApplicationUser.lastName)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.name)
                        </td>

                        <td>
                            @Html.DisplayFor(model => model.created)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.area)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.adress)
                        </td>

                        <td>
                            @Html.DisplayFor(model => model.cityArea)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.country)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.stateProvince)
                        </td>
                        <td>
                            @Html.DisplayFor(model => model.postalCode)
						</td>
                    </tr>

                </table>
                @*@Html.ActionLink("Edit", "Edit", new { id = Model.houseID }) |*@
                <div class="hidden-print"><span class="fa fa-reply hidden-print"></span>
                 @Html.ActionLink("Back to List", "Details","Account",new { id = Model.ApplicationUser.Id}, null )</div>
        </div>
    </div>

    <div class="panel-group">
        <div class="panel panel-warning">
            <div id="PanelHeading" class="panel-heading hidden-print">
                Movements of house
            </div>
            <div class="PbodyDetailsHouse panel-body">
                @if (User.IsInRole("Administrador"))
                {
                    <div class="col-md-3 hidden-print">
                        <span class="fa fa-plus-circle"></span>@Html.ActionLink("Create new movement", "Create", "Movements", new { id = Model.houseID }, null)
                    </div>
                }

            </div>
            <div class="row">
                <div id="Filtros" class="hidden-print col-md-12">
                    @if (User.IsInRole("Administrador"))
                    {
                        using (Html.BeginForm("Index", "Movements", FormMethod.Post, new { @class = "col-xs-4" }))
                        {
                            @Html.Label("Date")
                            <input type="Month" name="fecha" class="hidden-print" style="text-align:right;" required>
                            @Html.Hidden("houseID", Model.houseID)
                            @Html.Hidden("Accion", "Autorizar")
                            @Html.Hidden("IdUser", Model.Id)

                            <input type="submit" value="Approve" class="hidden-print" style="text-align:right;" />
                        }
                        using (Html.BeginForm("Index", "Movements", FormMethod.Post, new { @class = "col-xs-4" }))
                        {
                            @Html.Label("Date")
                            <input type="Month" name="fecha" class="hidden-print" style="text-align:right;" required>
                            @Html.Hidden("houseID", Model.houseID)
                            @Html.Hidden("Accion", "Desautorizar")
                            @Html.Hidden("IdUser", Model.Id)
                            <input type="submit" value="Unapprove" class="hidden-print" style="text-align:right;" />
                        }
                    }
                    @using (Html.BeginForm("Details", "Houses", FormMethod.Get, new { @class = "col-xs-4     " }))
                    {
                        @Html.Label("Date")
                        <input type="Month" name="fecha" class="hidden-print" style="text-align:right;" required>
                        @Html.Hidden("houseID", Model.houseID)
                        <input type="submit" value="Search by Date" class="hidden-print" style="text-align:right;" />
                    }
                </div>
            </div>
            <!--style="margin-top: -40px;width: 968px;margin-left:-15px"-->
            <div class="panel-body">
                <!--style="margin-top: -20px;padding: 0px;padding-top:28px;"-->
                <table id="tabla" ta class="table table-striped table-hover col-md-12 table-responsive">
                    <thead>
                        <tr>
                            @*<th>
                                    @Html.DisplayName("Name of house")
                                </th>*@
                            @if (User.IsInRole("Administrador"))
                            { 
                            <th class="hidden-print">
                                @Html.DisplayNameFor(mov=>m.FirstOrDefault().createBy)
                            </th>
                            }

                            <th>
                                @Html.DisplayName("Transaction Date")
                            </th>

                            <th>
                                @Html.DisplayName("Type")
                            </th>

                            @*<th>
                                    @Html.DisplayName("Value")
                                </th>*@
                            <th>
                                @Html.DisplayName("Service")
                            </th>
                            <th>
                                @Html.DisplayNameFor(mov=>m.FirstOrDefault().description)
                            </th>
                                @if (User.IsInRole("Administrador"))
                                {
                                <th>
                                    @Html.DisplayName("Status")
                                </th>
                                }
                            <th>
                                @Html.DisplayName("Amount")
                            </th>
                            <th>
                                @Html.DisplayName("Balance")
                            </th>
                            @if (User.IsInRole("Administrador"))
                            {
                            <th class="hidden-print">
                                @Html.DisplayName("Actions")
                            </th>
                            }
                            @*<th>
                                    @Html.DisplayNameFor(model => model.UserID)
                                </th>*@
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in m)
                        {
                            <tr>
                                @*<td>
                                        @Html.DisplayFor(modelItem => item.name)
                                    </td>*@
                                @if (User.IsInRole("Administrador"))
                                {
                                <td class="hidden-print">
                                    @Html.DisplayFor(modelItem => item.createBy)
                                </td>
                                }

                                <td>
                                    @Html.DisplayFor(modelItem => item.transactionDate)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.typeOfMovement)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.services.name)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.description)
                                </td>

                                @if (User.IsInRole("Administrador"))
                                {
                                <td>
                                    @Html.DisplayFor(modelItem => item.state)
                                </td>
                                }
                                @*<td>
                                        @Html.DisplayFor(modelItem => item.value)
                                    </td>*@

                                <td>
                                    @*Html.DisplayFor(modelItem => item.amount)*@
                                    $@String.Format("{0:n}", item.amount)
                                </td>

                                <td class=@(item.balance < 0 ? "balanceNegativo" : "")>
                                    @Html.DisplayFor(modelItem => item.balance)
                                </td>
                                @*<td>
                                    @Html.DisplayFor(modelItem => item.UserID)
                                </td>*@
                                @if (User.IsInRole("Administrador"))
                                {
                                    <td class="hidden-print">
                                        <span class="fa fa-pencil-square-o"></span>@Html.ActionLink("Edit", "Edit", "Movements", new { id = item.movementID }, null) |
                                        |<span class="fa fa-trash-o"></span> @Html.ActionLink("Delete", "Delete", "Movements", new { id = item.movementID }, null)
                                    </td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="hidden-print" style="display: inline-flex;">
       
        <input type="button" class="hidden-print"
               onClick="window.print()"
               value="Print Montly Statement" />

        </div>
    </div>


</div>